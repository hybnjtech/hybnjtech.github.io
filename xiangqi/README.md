# 中国象棋人机对战（离线版）

纯前端 HTML/CSS/JS 实现的中国象棋（Xiangqi）人机对战程序，无需网络、无需付费 API、无需构建工具。

## 如何运行

直接打开 `xiangqi-ai/index.html` 即可开始游戏。

若浏览器对本地文件有限制，可在项目目录运行本地静态服务器：

```bash
cd xiangqi-ai
python -m http.server 8000
```

然后访问 `http://localhost:8000/`。

## 功能说明

- 玩家 vs 电脑：可选择执红/执黑。
- AI 三档难度：初级 / 中级 / 高阶。
- 完整走子规则：将军判定、应将、将帅照面、吃子规则、胜负判定。
- UI 交互：点击选子 -> 高亮落点 -> 点击走子。
- 支持悔棋（至少一步）、新开局、交换先后手、认输。
- 内置古典氛围背景音乐（可开关、可调音量，需用户点击启用）。

## AI 难度策略

- 初级：深度 2，15% 概率选次优着法（随机从前几名里挑）。
- 中级：深度 4，5% 概率选次优着法，带基础走法排序（优先吃子）。
- 高阶：迭代加深至深度 6 或 1.2 秒时间上限，Alpha-Beta 剪枝 + 走法排序。

## 目录结构

```
xiangqi-ai/
  index.html
  style.css
  main.js
  engine/
    board.js       # 局面表示、走子执行/撤销
    movegen.js     # 走子生成（伪合法）
    rules.js       # 合法性判断、将军判定、胜负、测试
  ai/
    evaluate.js    # 评估函数
    search.js      # Minimax/Alpha-Beta 搜索
  audio/
    music.js       # 内置古典风背景音乐
  README.md
```

## 基础测试

页面加载时会自动运行 `Xiangqi.Rules.validateEngine()` 并输出到控制台。
也可在控制台手动调用该函数查看详情：

```js
Xiangqi.Rules.validateEngine();
```

覆盖点包括：
- 初始局面可生成合法走法
- 炮吃子需隔一子
- 将帅照面判定

## 已知限制

- 未实现重复局面/长将/50 回合等高级和棋判定。
- 评估函数为基础版本，强度仍有提升空间。
- 部分浏览器会阻止自动播放音频，需手动点击“开启音乐”。
